<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช ุงูููุงุฆู - ูุฑูุฒ ุงูุฑุงุดุฏ</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 50px; background: #f4f7f9; }
        .test-card { background: white; padding: 30px; border-radius: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); display: inline-block; max-width: 400px; }
        button { padding: 15px 30px; font-size: 18px; cursor: pointer; background: #1c4587; color: white; border: none; border-radius: 10px; width: 100%; }
        .status { margin-top: 20px; font-weight: bold; font-size: 14px; }
    </style>
</head>
<body>

<div class="test-card">
    <h2>ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช (ุงููุทูุฑ)</h2>
    <p>ูุฐุง ุงูุงุฎุชุจุงุฑ ูุณุชุฎุฏู ุงูู Service Worker ูุญู ุงููุดููุฉ ุงูุชู ุธูุฑุช ูู ุงูุตูุฑุฉ.</p>
    <button onclick="requestAndShow()">ุชูุนูู ูุฅุฑุณุงู ุฅุดุนุงุฑ</button>
    <div id="status" class="status">ุจุงูุชุธุงุฑ ุงูุถุบุท ุนูู ุงูุฒุฑ...</div>
</div>

<script>
    async function requestAndShow() {
        const statusDiv = document.getElementById('status');
        statusDiv.style.color = "blue";
        statusDiv.innerText = "ุฌุงุฑู ุทูุจ ุงูุฅุฐู ูุชุณุฌูู ุงููุธุงู...";

        // 1. ุทูุจ ุฅุฐู ุงูุชูุจููุงุช
        const permission = await Notification.requestPermission();
        
        if (permission !== 'granted') {
            statusDiv.style.color = "red";
            statusDiv.innerText = "ุชู ุฑูุถ ุงูุฅุฐู. ูุฑุฌู ุงูุณูุงุญ ูู ุฅุนุฏุงุฏุงุช ุงููุชุตูุญ.";
            return;
        }

        // 2. ุงูุชุญูู ูู ูุฌูุฏ ููู sw.js ูุชุดุบููู
        if ('serviceWorker' in navigator) {
            try {
                const reg = await navigator.serviceWorker.register('sw.js');
                statusDiv.style.color = "green";
                statusDiv.innerText = "ุชู ุงูุชุณุฌูู ุจูุฌุงุญ! ุฌุงุฑู ุฅุฑุณุงู ุงูุฅุดุนุงุฑ...";

                // 3. ุฅุฑุณุงู ุงูุฅุดุนุงุฑ ุจุงุณุชุฎุฏุงู ุงูุทุฑููุฉ ุงูุชู ุทูุจูุง ุงูุฃูุฏุฑููุฏ
                const options = {
                    body: "ุดูุฑุงู ูุซูุชู ุจูุฑูุฒ ุงูุฑุงุดุฏ.. ุชู ุชูุนูู ุงููุธุงู ุจูุฌุงุญ โ",
                    icon: "https://cdn-icons-png.flaticon.com/512/1161/1161388.png",
                    badge: "https://cdn-icons-png.flaticon.com/512/1161/1161388.png",
                    dir: "rtl",
                    vibrate: [100, 50, 100] // ุงูุชุฒุงุฒ ุจุณูุท ููููุจุงูู
                };

                // ุฅุธูุงุฑ ุงูุฅุดุนุงุฑ ููุฑุงู
                await reg.showNotification('ูุฑูุฒ ุงูุฑุงุดุฏ ููุงุชุตุงูุงุช ๐ฑ', options);
                
            } catch (err) {
                statusDiv.style.color = "red";
                statusDiv.innerText = "ูุดู ุชุณุฌูู sw.js: " + err.message;
            }
        } else {
            statusDiv.style.color = "red";
            statusDiv.innerText = "ูุชุตูุญู ูุฏูู ุฌุฏุงู ููุง ูุฏุนู ุงูุชูููุงุช ุงูุญุฏูุซุฉ.";
        }
    }
</script>

</body>
</html>
